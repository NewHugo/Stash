# autocorrect-disable
mixed-port: 7890
mode: rule
log-level: info

http:
  # 强制使用 Stash 引擎以 HTTP 协议处理 TCP 连接
  # 捕获后的连接可以使用高级功能，例如重写和脚本
  force-http-engine:
    - '*:80'
    - '*:4480' # BiliBili CDN
    - '*:9102' # BiliBili CDN

# 假如用组合订阅多个机场，就没必要使用 subscribe-url 了
subscribe-url: https://sub.store/download/collection/subs
# 替换上面文字用于 Stash 获取机场流量信息并在主页显示

# 远程资源默认配置
remote-resources-default-config: &remote-resources-default-config
  type: http
  interval: 86400

proxy-providers:
  # 全部节点
  all-sub: &all-sub # 建立锚点
    <<: *remote-resources-default-config
    # 1.此处使用 Sub-Store 与 Clash 类型订阅链接 可以替换下面的 url：后所有文字包括""多个链接使用英文符号的竖杠 | 隔开一起写上即可
    # 2.使用非Sub-Store 与 Clash 类型订阅替换后面""之间订阅链接四个字为机场url地址即可
    url: "https://api.v1.mk/sub?target=clash&url=订阅链接&emoji=true&list=true&udp=true"
    path: ./all.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

proxy-groups:  
  - name: SSID自动策略
    type: select
    icon: https://github.com/Koolson/Qure/blob/master/IconSet/Color/SSID.png?raw=true
    proxies:
    # 此处为配置文件中的已有策略组
      - Server策略
      - DIRECT  # 虽说 DIRECT 是保留字。但必须配置该策略选项，于此代理集的 proxies 下，不然该代理集就只有 1 个策略选项
    ssid-policy:
    # cellular: 保留字，指代蜂窝数据条件下
    # default：保留字，指代其他 SSID 条件下，默认为 DIRECT 策略
    # DIRECT：保留字，直连策略
      Fuck_Great Fire Wall: DIRECT  # Fuck_Great Fire Wall，为 SSID 名称
      cellular: Server策略
      default: Server策略

  - name: Server策略
    type: select
    icon: https://github.com/Koolson/Qure/blob/master/IconSet/Color/Server.png?raw=true
    proxies:
      - 自动选择
      - 手动选择

  - name: 手动选择
    type: select
    icon: https://github.com/Koolson/Qure/blob/master/IconSet/Color/Rocket.png?raw=true
    use:
      - all-sub

  - name: 自动选择
    type: url-test
    icon: https://github.com/Koolson/Qure/blob/master/IconSet/Color/Auto.png?raw=true
    url: http://www.gstatic.com/generate_204
    interval: 300
    use:
      - all-sub

rule-providers:

  GoogleCNProxyIP: # 内容：GoogleCNProxyIP 谷歌中国服务
    <<: *remote-resources-default-config
    behavior: ipcidr
    url: https://raw.githubusercontent.com/NewHugo/Stash/main/Ruleset/GoogleCNProxyIP.yaml
    path: ./ruleset/GoogleCNProxyIP.yaml

  Bing: # 内容：Bing
    <<: *remote-resources-default-config
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Bing/Bing.yaml
    path: ./ruleset/Bing.yaml

  LocalAreaNetwork: # 本地/局域网地址
    <<: *remote-resources-default-config
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/LocalAreaNetwork.yaml
    path: ./ruleset/LocalAreaNetwork.yaml

  ChinaMax_Domain: # 内容：ChinaMax_Domain
    <<: *remote-resources-default-config
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMax/ChinaMax_Domain.txt
    path: ./ruleset/ChinaMax_Domain.yaml

  ChinaCompanyIp: # 中国云服务商ip端
    <<: *remote-resources-default-config
    behavior: ipcidr
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/ChinaCompanyIp.yaml
    path: ./ruleset/ChinaCompanyIp.yaml

  ChinaMax_IP: # 内容：ChinaMax_IP
    <<: *remote-resources-default-config
    behavior: ipcidr
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMax/ChinaMax_IP.txt
    path: ./ruleset/ChinaMax_IP.yaml

  ChinaMax: # 内容：ChinaMax
    <<: *remote-resources-default-config
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMax/ChinaMax.yaml
    path: ./ruleset/ChinaMax.yaml

 Apple_Domain: # 内容：Apple
    <<: *remote-resources-default-config
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Domain.txt
    path: ./ruleset/Apple_Domain.yaml

  Rule-DIRECT: #自用补充直连
    <<: *remote-resources-default-config
    behavior: classical
    url: https://raw.githubusercontent.com/NewHugo/Stash/main/Ruleset/Rule-DIRECT.yaml
    path: ./ruleset/Rule-DIRECT.yaml

  Rule-Proxy: #自用补充代理
    <<: *remote-resources-default-config
    behavior: classical
    url: https://raw.githubusercontent.com/NewHugo/Stash/main/Ruleset/Rule-Proxy.yaml
    path: ./ruleset/Rule-Proxy.yaml

rules:
  - RULE-SET,ChinaCompanyIp,DIRECT,no-resolve
  - RULE-SET,ChinaMax_IP,DIRECT,no-resolve
  - RULE-SET,GoogleCNProxyIP,SSID自动策略
  - RULE-SET,Bing,SSID自动策略
  - RULE-SET,LocalAreaNetwork,DIRECT
  - RULE-SET,ChinaMax,DIRECT
  - RULE-SET,ChinaMax_Domain,DIRECT
  - RULE-SET,Apple_Domain,DIRECT
  - RULE-SET,Rule-DIRECT,DIRECT
  - RULE-SET,Rule-Proxy,SSID自动策略
  - GEOIP,CN,DIRECT,no-resolve
  - MATCH,SSID自动策略
